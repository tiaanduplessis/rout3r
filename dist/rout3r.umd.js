!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("history"),require("wayfarer")):"function"==typeof define&&define.amd?define(["exports","react","history","wayfarer"],e):e(t.rout3r={},t.react,t.history,t.wayfarer)}(this,function(t,e,r,n){var o="default"in e?e.default:e;n=n&&n.hasOwnProperty("default")?n.default:n;var a=e.createContext(),i=a.Provider,s=a.Consumer;t.Router=function(t){function e(e){var a=this;t.call(this,e),this.history=e.history||r.createBrowserHistory(),this.unlisten=null,this.router=n(e.defaultPath||"/"),this.actions={push:this.history.push,goBack:this.history.goBack,goForward:this.history.goForward,replace:this.history.replace},o.Children.map(e.children,function(t){return a.addRoute(t)}),this.state={search:window.location.search,url:window.location.pathname}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.componentDidMount=function(){var t=this;this.unlisten=this.history.listen(function(e){var r=e.pathname,n=e.search;t.setState(function(t){return Object.assign({},t,{url:r,search:n})})})},e.prototype.componentWillUnmount=function(){this.unlisten()},e.prototype.addRoute=function(t){this.router.on(t.props.path,function(e){return function(t,e){return o.createElement(s,null,function(r){var n,a=r.state,i=r.push,s=r.replace,u=r.goBack,c=r.goForward;return o.cloneElement(t,{path:a.url,searchParams:(n=a.search,void 0===n&&(n=""),n?(/^[?#]/.test(n)?n.slice(1):n).split("&").reduce(function(t,e){var r=e.split("="),n=r[1];return t[r[0]]=n?decodeURIComponent(n.replace(/\+/g," ")):"",t},{}):{}),push:i,replace:s,goBack:u,goForward:c,params:e})})}(t,e)})},e.prototype.render=function(){var t=this.state.url;return o.createElement(i,{value:Object.assign({},{state:this.state},this.actions)},this.router(t))},e}(o.Component),t.Link=function(t){var e=t.path,r=t.href,n=t.children,a=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(r[n]=t[n]);return r}(t,["path","href","children"]),i=r||e;return o.createElement(s,null,function(t){var e=t.push;return o.createElement("a",Object.assign({},a,{href:i,onClick:function(t){t.preventDefault(),e(i)}}),n)})}});
