import t,{createContext as r}from"react";import{createBrowserHistory as o}from"history";import n from"wayfarer";var e=r(),i=e.Provider,a=e.Consumer,s=function(r){function e(e){var i=this;r.call(this,e),this.history=e.history||o(),this.unlisten=null,this.router=n(e.defaultPath||"/"),this.actions={push:this.history.push,goBack:this.history.goBack,goForward:this.history.goForward,replace:this.history.replace},t.Children.map(e.children,function(t){return i.addRoute(t)}),this.state={search:window.location.search,url:window.location.pathname}}return r&&(e.__proto__=r),(e.prototype=Object.create(r&&r.prototype)).constructor=e,e.prototype.componentDidMount=function(){var t=this;this.unlisten=this.history.listen(function(r){var o=r.pathname,n=r.search;t.setState(function(t){return Object.assign({},t,{url:o,search:n})})})},e.prototype.componentWillUnmount=function(){this.unlisten()},e.prototype.addRoute=function(r){this.router.on(r.props.path,function(o){return function(r,o){return h(a,null,function(n){var e=n.state,i=n.push,a=n.replace,s=n.goBack,c=n.goForward;return t.cloneElement(r,{path:e.url,searchParams:u(e.search),push:i,replace:a,goBack:s,goForward:c,params:o})})}(r,o)})},e.prototype.render=function(){var t=this.state.url;return h(i,{value:Object.assign({},{state:this.state},this.actions)},this.router(t))},e}(t.Component);function c(t){var r=t.path,o=t.href,n=t.children,e=function(t,r){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===r.indexOf(n)&&(o[n]=t[n]);return o}(t,["path","href","children"]),i=o||r;return h(a,null,function(t){var r=t.push;return h("a",Object.assign({},e,{href:i,onClick:function(t){t.preventDefault(),r(i)}}),n)})}function u(t){return void 0===t&&(t=""),t?(/^[?#]/.test(t)?t.slice(1):t).split("&").reduce(function(t,r){var o=r.split("="),n=o[1];return t[o[0]]=n?decodeURIComponent(n.replace(/\+/g," ")):"",t},{}):{}}export{s as Router,c as Link};
